---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import Section from '../../../components/Section.astro';
import PhotoFilter from '../../../components/PhotoFilter.astro';
import PhotoGrid from '../../../components/PhotoGrid.astro';
import { allPhotos, formatCategory } from '../../../data/photos';

// Define a props interface for type safety
interface Props {
  categoryPhotos: typeof allPhotos;
  categoryTitle: string;
}

// Export getStaticPaths using the precomputed uniqueCategories
export function getStaticPaths() {
  const uniqueCategories = [...new Set(allPhotos.map(photo => photo.category))];
  return uniqueCategories.map(category => {
    const categoryPhotos = allPhotos.filter(photo => photo.category === category);
    return {
      params: { category },
      props: {
        categoryPhotos,
        categoryTitle: formatCategory(category)
      }
    };
  });
}

// Get the category-specific props from Astro.props using the defined interface
const { categoryPhotos, categoryTitle } = Astro.props as Props;

// Prepare all categories for the PhotoFilter component
const allCategories = [...new Set(allPhotos.map(photo => photo.category))].map(formatCategory);

// Define a mapping for hero section descriptions for better maintainability
const heroDescriptions: Record<string, string> = {
  Birds: 'Distant islands of stars in the cosmic ocean',
  Primates: 'Our celestial neighbors in the solar system',
  Mammals: 'Cosmic clouds of gas and dust'
};
---

<BaseLayout title={`${categoryTitle} Photos | Adrian Diaz`}>
  <!-- Hero Section -->
  <div class="relative h-[40vh] min-h-[300px] bg-gradient-to-r from-blue-900 to-purple-900 flex items-center justify-center">
    <div class="text-center text-white px-4 z-10">
      <h1 class="text-4xl md:text-5xl font-bold mb-4 tracking-tight">{categoryTitle}</h1>
      <p class="text-xl max-w-2xl mx-auto text-white/90">
        {heroDescriptions[categoryTitle] ?? ''}
      </p>
    </div>
  </div>

  <!-- Main Content -->
  <Section background="white" paddingY="large">
    <div class="max-w-7xl mx-auto">
      <PhotoFilter 
        categories={allCategories} 
        activeCategory={categoryTitle} 
        includeAllPhotos={true} 
      />
      <PhotoGrid photos={categoryPhotos} />
    </div>
  </Section>
</BaseLayout>