---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import Section from '../../../components/Section.astro';
import PhotoGallery from '../../../components/PhotoGallery.astro';
import PhotoFilter from '../../../components/PhotoFilter.astro';

// This function is required for dynamic routes in static site generation
export function getStaticPaths() {
  // Define all the categories we want to generate pages for
  const categories = ['galaxies', 'nebulae', 'stars', 'planets', 'phenomena', 'equipment'];
  
  return categories.map(category => {
    return {
      params: { category },
      props: { categoryTitle: category.charAt(0).toUpperCase() + category.slice(1) }
    };
  });
}

// Get the category from props
const { category } = Astro.params;
const { categoryTitle } = Astro.props;

// In a real app, you would filter photos by category from your data source
// For now, we'll use a static set of photos
const allPhotos = [
  {
    src: "/photography/galaxy1.jpg",
    alt: "Spiral Galaxy",
    caption: "Spiral Galaxy M51",
    date: "June 2023",
    location: "Atacama Desert, Chile",
    category: "galaxies",
    featured: true
  },
  {
    src: "/photography/nebula1.jpg",
    alt: "Orion Nebula",
    caption: "Orion Nebula",
    date: "January 2023",
    location: "La Palma, Spain",
    category: "nebulae"
  },
  {
    src: "/photography/stars1.jpg",
    alt: "Star Trails",
    caption: "Star Trails over Mountains",
    date: "August 2022",
    location: "Sierra Nevada, USA",
    category: "stars"
  },
  {
    src: "/photography/moon1.jpg",
    alt: "Full Moon",
    caption: "Full Moon Detail",
    date: "October 2022",
    location: "Home Observatory",
    category: "planets"
  },
  {
    src: "/photography/aurora1.jpg",
    alt: "Aurora Borealis",
    caption: "Northern Lights",
    date: "March 2023",
    location: "Iceland",
    category: "phenomena",
    featured: true
  },
  {
    src: "/photography/milkyway1.jpg",
    alt: "Milky Way",
    caption: "Milky Way Core",
    date: "July 2022",
    location: "Death Valley, USA",
    category: "galaxies"
  },
  {
    src: "/photography/eclipse1.jpg",
    alt: "Solar Eclipse",
    caption: "Total Solar Eclipse",
    date: "April 2023",
    location: "Australia",
    category: "phenomena"
  },
  {
    src: "/photography/telescope1.jpg",
    alt: "Telescope Setup",
    caption: "Astrophotography Setup",
    date: "May 2022",
    location: "Home Observatory",
    category: "equipment"
  },
  {
    src: "/photography/planets1.jpg",
    alt: "Jupiter",
    caption: "Jupiter and its Moons",
    date: "September 2022",
    location: "Home Observatory",
    category: "planets"
  }
];

// Filter photos by category
const photos = category 
  ? allPhotos.filter(photo => photo.category === category.toLowerCase())
  : allPhotos;

// Get all unique categories
const categories = [...new Set(allPhotos.map(photo => photo.category))].map(
  cat => cat.charAt(0).toUpperCase() + cat.slice(1)
);
---

<BaseLayout>
  <div class="category-hero relative h-[30vh] min-h-[250px] flex items-center justify-center overflow-hidden">
    <div class="absolute inset-0 z-0">
      <div class="absolute inset-0 bg-gradient-to-b from-[var(--apple-gray-900)] to-[var(--apple-gray-800)]"></div>
    </div>
    
    <div class="relative z-10 text-center text-white px-4">
      <h1 class="text-3xl md:text-4xl font-bold mb-2 tracking-tight">{categoryTitle} Photography</h1>
      <p class="text-lg max-w-2xl mx-auto text-white/80">Exploring the cosmos through the lens</p>
    </div>
  </div>
  
  <Section background="white" paddingY="large">
    <div class="max-w-7xl mx-auto">
      <PhotoFilter categories={categories} activeCategory={categoryTitle} />
      
      {photos.length > 0 ? (
        <PhotoGallery photos={photos} masonry={true} />
      ) : (
        <div class="text-center py-12">
          <h2 class="text-2xl font-medium text-[var(--apple-gray-700)] dark:text-[var(--apple-gray-300)] mb-4">No photos found</h2>
          <p class="text-[var(--apple-gray-500)] dark:text-[var(--apple-gray-400)] mb-8">There are no photos in this category yet.</p>
          <a href="/photography" class="inline-flex items-center text-[var(--apple-blue)] font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
            </svg>
            Back to all photos
          </a>
        </div>
      )}
    </div>
  </Section>
</BaseLayout>

<style>
  /* Add a subtle pattern to the category hero background */
  .category-hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
      radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 10%),
      radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 10%);
    background-size: 60px 60px;
    opacity: 0.3;
    z-index: 1;
  }
</style>