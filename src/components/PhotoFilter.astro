---
import PhotoLink from './PhotoLink.astro';

// You can also 'export' this interface if you'd like to import it elsewhere.
interface Props {
  categories: string[];
  activeCategory?: string;
  centered?: boolean;
  showViewAll?: boolean;
  includeAllPhotos?: boolean; // Controls whether to show the "All Photos" filter
}

const {
  categories = [],         // Fallback to empty array if not provided
  activeCategory,
  centered = false,
  showViewAll = false,
  includeAllPhotos = true, // Defaults to true for backward compatibility
} = Astro.props as Props;

function getCategoryUrl(category: string) {
  // If your category names have spaces or other special chars,
  // consider a proper slugify instead of just .toLowerCase()
  return `/photography/category/${category.toLowerCase()}`;
}

function isActive(category: string) {
  return category === activeCategory;
}

// Build the final list of categories to display
const displayCategories = includeAllPhotos
  ? ['All', ...categories]
  : categories;
---

<div class="photo-filter mb-8">
  <div class={`flex flex-wrap gap-3 ${centered ? 'justify-center w-full' : ''}`}>
    {displayCategories.map((category) => {
      // Decide label and URL
      const isAll = category === 'All';
      const href = isAll ? '/photography' : getCategoryUrl(category);
      const label = isAll ? 'All Photos' : category;
      const active =
        (isAll && (!activeCategory || activeCategory === 'All')) ||
        (!isAll && isActive(category));

      return (
        <a
          href={href}
          class={`px-4 py-2 rounded-full text-sm font-medium transition-colors border ${
            active
              ? 'border-[var(--apple-blue)] bg-white dark:bg-[var(--apple-gray-900)] text-[var(--apple-blue)] font-semibold shadow-md shadow-blue-100 dark:shadow-blue-900/50'
              : 'border-transparent bg-[var(--apple-gray-100)] text-[var(--apple-gray-700)] dark:bg-[var(--apple-gray-800)] dark:text-[var(--apple-gray-300)] hover:bg-[var(--apple-gray-50)] dark:hover:bg-[var(--apple-gray-700)]'
          }`}
        >
          {label}
        </a>
      );
    })}
  </div>

  {showViewAll && (
    <div class="mt-6 text-center">
      <PhotoLink href="/photography" />
    </div>
  )}
</div>

<style>
  .photo-filter {
    position: relative;
    width: 100%;
  }
  
  .photo-filter::after {
    content: '';
    position: absolute;
    bottom: -16px;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(to right, transparent, var(--apple-gray-200), transparent);
    opacity: 0.6;
  }
  
  .dark .photo-filter::after {
    background: linear-gradient(to right, transparent, var(--apple-gray-700), transparent);
  }
</style>